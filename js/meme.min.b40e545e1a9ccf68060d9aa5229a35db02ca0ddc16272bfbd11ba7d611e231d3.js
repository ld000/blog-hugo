const throttle=(e,t)=>{let s,o,n;return function(){const i=this,a=arguments;s?(clearTimeout(o),o=setTimeout(function(){Date.now()-n>=t&&(e.apply(i,a),n=Date.now())},Math.max(t-(Date.now()-n),0))):(e.apply(i,a),n=Date.now(),s=!0)}},delayTime=420,headerFallbackWidth="36em",headerInner=document.querySelector(".header-inner"),mainInner=document.querySelector(".main-inner");if(mainInner!==null){const e=window.getComputedStyle(mainInner,null).getPropertyValue("width");headerInner.style.setProperty("--main-inner",e)}else headerInner.style.setProperty("--main-inner",headerFallbackWidth);headerInner.style.setProperty("opacity",1);function addDisplayNone(e){const t=document.getElementById(e);if(t!==null){const e=t.getAttribute("data-hide");e!==null&&(t.parentNode.style="display: none")}}addDisplayNone("theme-switcher"),addDisplayNone("lang-switcher");const navToggleLabel=document.querySelector(".nav-toggle"),navToggleLabelInner=document.createElement("div");navToggleLabelInner.className="nav-toggle-inner",navToggleLabel.appendChild(navToggleLabelInner);for(let e=0;e<3;e++){const t=document.createElement("span");navToggleLabelInner.appendChild(t)}const navToggle=document.getElementById("nav-toggle"),header=document.querySelector(".header"),navCurtain=document.querySelector(".nav-curtain");navToggle.addEventListener("change",e=>{e.target.checked?(header.classList.add("open"),navToggleLabel.classList.add("open"),header.classList.remove("fade"),navCurtain.style="display: block"):(header.classList.remove("open"),navToggleLabel.classList.remove("open"),header.classList.add("fade"))}),navCurtain.addEventListener("animationend",e=>{navToggle.checked||e.target.removeAttribute("style")}),window.addEventListener("scroll",throttle(function(){closeNav()},delayTime)),window.addEventListener("resize",throttle(function(){closeNav()},delayTime));function closeNav(){navToggle.checked&&(navToggle.checked=!1,header.classList.remove("open"),navToggleLabel.classList.remove("open"),header.classList.add("fade"))}const backToTop=document.getElementById("back-to-top");backToTop!==null&&window.addEventListener("scroll",throttle(function(){window.scrollY>100?backToTop.classList.add("show"):backToTop.classList.remove("show")},delayTime)),userPrefers==="dark"?changeMode("dark"):userPrefers==="light"?changeMode("light"):darkModeMediaQuery.matches?changeMode("dark"):lightModeMediaQuery.matches&&changeMode("light"),darkModeMediaQuery.addListener(e=>{const t=e.matches;t&&(changeModeMeta("dark"),changeMode("dark"))}),lightModeMediaQuery.addListener(e=>{const t=e.matches;t&&(changeModeMeta("light"),changeMode("light"))});const themeSwitcher=document.getElementById("theme-switcher");themeSwitcher.addEventListener("click",function(){const e=document.documentElement.getAttribute("data-theme");e==="dark"?(changeModeMeta("light"),changeMode("light"),storePrefers("light")):(changeModeMeta("dark"),changeMode("dark"),storePrefers("dark"))}),window.addEventListener("storage",function(e){e.newValue==="dark"?(changeModeMeta("dark"),changeMode("dark")):(changeModeMeta("light"),changeMode("light"))});function changeMode(e){var n,s,t=e==="dark";document.getElementById("theme-switcher").innerHTML=t?"🌙":"🌞",n=t?"chroma":"chroma-dark",s=t?"chroma-dark":"chroma",[].slice.apply(document.getElementsByClassName(n)).forEach(e=>{e.className=s})}function storePrefers(e){window.localStorage.setItem("theme",e)}document.querySelectorAll("table").forEach(e=>{e.outerHTML=`<div class="table-container">${e.outerHTML}</div>`});const copyText="复制",copiedText="已复制";document.querySelectorAll(".post-body > pre").forEach(e=>{e.outerHTML=`<div style="position: relative">${e.outerHTML}</div>`});function addCopyButtons(e){const t=document.querySelectorAll("table.lntable, .highlight > pre, .post-body > div > pre");t.forEach(t=>{t.parentNode.style.position="relative";const n=document.createElement("button");if(n.className="copy-button",n.type="button",n.innerText=copyText,t.classList.contains("lntable"))var s=t.querySelectorAll(".lntd")[1];else s=t.querySelector("code");n.addEventListener("click",()=>{e.writeText(s.innerText).then(()=>{n.blur(),n.innerText=copiedText,setTimeout(()=>{n.innerText=copyText},1e3)}).catch(e=>{n.innerText="Error",console.error(e)})}),t.appendChild(n),t.parentNode.addEventListener("mouseover",()=>{n.style="visibility: visible; opacity: 1"}),t.parentNode.addEventListener("mouseout",()=>{n.style="visibility: hidden; opacity: 0"})})}if(navigator&&navigator.clipboard)addCopyButtons(navigator.clipboard);else{const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/clipboard-polyfill@2.8.6/dist/clipboard-polyfill.min.js",e.defer=!0,e.onload=function(){addCopyButtons(clipboard)},document.body.appendChild(e)}const commentsToggle=document.getElementById("load-comments");commentsToggle!==null&&commentsToggle.addEventListener("click",function(){loadComments(),this.style="display: none"})